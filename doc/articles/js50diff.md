# Differences between the JS-25 and the JS-50 Scanning Systems

In order to make the world's best sawmill scanner better with the JS-50, we have had to make some changes that break compatibility with the JS-25. Since releasing the first JS-20 scan heads in 2002, we've learned a lot about how to make a scanner that is simple and reliable even in the rough and tumble world of sawmill automation. Much of what we've learned has been incorporated incrementally into firmware updates and compatible platform updates, like the JS-20 to JS-25 update. Some of the improvements were not possible without breaking compatibility. While there will be some additional effort in transitioning from the JS-25 to the JS-50, there are many benefits to the new architecture. Below is an overview of the changes between the JS-25 and the JS-50 series of scan heads.  
# Orientation
Orientation, what was called calibration in JS-25, is not persisted on JS-50. It is stored in the optimizer computer and sent to the scan head upon connection. This is the data transform that returns profile points in a common mill coordinate system, instead of returning the points relative to each individual sensor. The orientation consists of 4 components, a flip of the coordinate system depending on whether the cable is up or downstream, a rotation, a roll in the laser plane, and an X and Y offset.  

The cable upstream or downstream is just a description of how the scan heads are mounted in the system. The other three parameters can be given a default value based upon the scan frame layout, but to achieve accurate results it will need to be calibrated by scanning a known shaped target at a specified location in the mill coordinate system. The optimizer can do this with their own routines, or we can provide a calibration routine the optimizer can use to assist in calibrating the orientation parameters.  
# Configuration
The param.dat configuration file on the JS-25 is no longer persisted in the the JS-50. The configuration parameters are passed in through the API when the program connects to the scan heads. It can be hard-coded, made part of the optimizer's configuration data, or automatically generated based upon higher level configuration settings.  

The biggest difference is the scanner phasing. With the JS-25 param.dat, the scanners were assigned a scan phase. All the scanners in a phase would scan simultaneously. In the JS-25, the software would automatically determine based on the phase table and the MaxLaserOn times when to fire each phase. With the JS-50, the optimizer only provides a time offset and the optimizer software is responsible for determining the phase timing and generating the offset for each scanner. We provide documentation describing how the phasing offsets are typically calculated for various systems types.  
# Assigning IP Addresses
The JS-50 also takes a different approach to assigning IP addresses to the scan heads. In the JS-25, these were set using a proprietary JSConfig software tool. With the JS-50, IP addresses are either assigned via a collaborative standard technology call, ZeroConf, or using DHCP. In practice the optimizer no longer needs to be concerned with IP addresses. In the JS-50 API, the connections are made based upon the serial numbers of the scan heads. We recommend having the scanners on an isolated network that is only accessible from the optimizer PC.  
# Single Power Over Ethernet (POE) Cable
On the JS-25, the power, encoder, and synchronization signals were provided over a separate 8 conductor cable. This cable was then wired into terminal strips at the junction box. There were two main downsides. First, putting together and wiring up the junction box was time consuming with much of that work having to be done onsite, slowing down the startup. Second, cables are the largest source of failure. On the JS-25, if either cable was faulty the scanner would fail to function. Additionally, when a scanner was not functioning correctly you had two cables to check. The JS-50, by going to a single cable that terminates into an industry standard Gigabit Ethernet Power over Ethernet (POE) switch, makes startups faster and simpler, improves system reliability, and simplifies diagnosing problems.  
# Encoder Inputs
With a JS-25 system, encoder inputs were distributed to all the scan heads in the system. With the JS-50, up to four encoders are connected to a ScanSync module which then distributes the encoder location along with timing synchronization over Ethernet. To ensure that the encoder and time synchronization are accurate, the ScanSync and all of the JS-50 scan heads in the system must be on a single Ethernet switch.   
# Scanning Modes
The JS-25 supported a number of synchronized scanning modes, based on the encoder motion, time, or synchronization pulses. The JS-50 only supports a time synchronized scanning. After the scan heads have been added to the system and configured with phase offsets, a call is made to start the system scanning at a given rate.  
# Data Transmission 
In the JS-25, the communications with the scanners was done over TCP, but with the JS-50, communications are over UDP. The main reason for this change is that TCP requires retransmission when a packet is dropped, which can delay data for 250 ms or more. On a high speed trimmer, this is an intolerable delay and almost impossible for the optimizer to handle gracefully. With the JS-50's UDP implementation, a single dropped packet will at most drop the single profile point, and in practice it will produce a profile with some of the profile points missing. For many optimization systems this will require no special logic to handle. We do provide fields in the profile reporting if there are missing profile points, and we recommend that the optimizer report if there are an abnormally high portion of dropped packets. In practice, it should be rare to have more than one in a million packets dropped.  
# PC and Ethernet Switch Requirements
Since the JS-50 uses UDP and profiles are sent immediately upon being taken, the optimizer PC must be continuously listening and processing the UDP packets as they arrive. The API does this in the background on a set of worker threads and queues the profiles locally for the optimizer. On a large system with a high scan rate, this can consume a non-trivial amount of CPU. The API is designed to be efficiently multi-threaded, so on large systems with high scan rates, larger workstation or server class machines with 8 or more cores are recommended.  

With the higher data rates and scan resolutions of the JS-50, the 100Mbit Ethernet used by the JS-25 is no longer sufficient. The JS-50 now uses Gigabit Ethernet, which requires a Gigabit switch. For any high performance systems we also recommend the switch have a 10Gbit up-link port that is connected to a 10Gbit NIC in the optimizer PC.  

The IEEE 802.3 standard for Power Over Ethernet (POE) has specifications for four levels of supply power. The lowest level, 802.3af, supplies the 13W of power required for the JS-50 scanner. Basically, any POE source that meets IEEE standards will power the JS-50 scanner. 
# Software and Firmware Versioning
Versioning is handled differently with the JS-50 compared to the JS-25. With the JS-25, we attempted to make any version of API compatible with any firmware revision. This made improving and maintaining the firmware and API difficult. With the JS-50, we require that the API version and the scanner firmware version be the same. This will give the optimizer the certainty that they are using a tested, known good API/Firmware combination, and give JoeScan more flexibility to improve the product.

